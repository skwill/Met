angular.module("ionic.metApp").controller("warningsCtrl",["metApi","$scope","$ionicModal","$ionicSlideBoxDelegate","$ionicScrollDelegate","$interval","$stateParams","$timeout",function(e,t,i,n,a,o,s,r){function l(e){var t=["January","February","March","April","May","June","July","Aug","September","October","November","December"],i=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],n=new Date(e);return i[n.getDay()+1]+" "+(n.getDate()+1)+"th of "+t[n.getMonth()]+" "+n.getFullYear()}var c=this,m=6e5;o(function(){$ionicHistory.clearCache().then(function(){$route.reload(),c.refresh_all_w(),$route.reload()}),$ionicHistory.clearHistory()},m),t.disableSwipe=function(){n.enableSlide(!1)},t.get_initial=function(){r(function(){t.slide(s.id)},1e3)},t.slideHasChanged=function(e){c.update_slide(e)},c.update_slide=function(e){titles=["Watches","Warnings","Sigmet","Airmet"],t.sub_title=titles[e]},t.slide=function(e){a.scrollTop(),n.slide(e)},c.refresh_all_w=function(){c.get_o_air(),c.get_sigmet(),c.get_warn(),c.get_watch()},c.refreshData=function(e){switch(e){case"Watches":c.get_watch();break;case"Warnings":c.get_warn();break;case"Sigmet":c.get_sigmet();break;case"Airmet":c.get_o_air()}},c.get_o_air=function(){e.get_o_air(function(e){c.o_items=e.items[0],console.log(c.o_items),c.o_items.insertionDateFormatted=l(e.items[0].insertionDate),"0"==c.o_items.flag&&(c.o_items=null)})},c.get_sigmet=function(){e.get_sigmet(function(e){c.s_items=e.items[0],c.s_items.insertionDateFormatted=l(e.items[0].insertionDate),"0"==c.s_items.flag&&(c.s_items=null)})},c.get_warn=function(){e.get_warn(function(e){c.w_items=e.items[0],c.w_items.insertionDateFormatted=l(e.items[0].insertionDate),"0"==c.w_items.flag&&(c.w_items=null)})},c.get_watch=function(){e.get_watch(function(e){c.wt_items=e.items[0],c.wt_items.insertionDateFormatted=l(e.items[0].insertionDate),"0"==c.wt_items.flag&&(c.wt_items=null)})},i.fromTemplateUrl("app/warnings/info_item.html",{scope:t,animation:"slide-in-up"}).then(function(e){t.w_details_modal=e}),t.w_info_close=function(){var e=document.querySelector(".modal");e.setAttribute("style",""),t.w_details_modal.hide()},t.w_info_open=function(i,n){switch(t.w_details_modal.show(),n){case"o":e.get_o_air(function(e){c.warning=e.items[0],c.warning.warnType=c.warning.forecaster},i);break;case"s":e.get_sigmet(function(e){c.warning=e.items[0]},i);break;case"w":e.get_warn(function(e){c.warning=e.items[0]},i);break;case"wt":e.get_watch(function(e){c.warning=e.items[0]},i)}},t.drag_close_modal=function(e){var i=window.innerHeight,n=e.gesture.center.pageY,a=document.querySelector(".modal"),o="; transition: all cubic-bezier(0.1, 0.7, 0.1, 1) 400ms;";a.setAttribute("style","margin-top:"+n+"px"+o),n>i/2&&t.w_info_close(),0>n&&a.setAttribute("style","margin-top:0px"+o),n>i&&t.w_info_close()},t.drag_release=function(){var e=document.querySelector(".modal"),t="; transition: all cubic-bezier(0.1, 0.7, 0.1, 1) 400ms;";e.setAttribute("style","margin-top:0px"+t)}}]);