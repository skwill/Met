angular.module("ionic.metApp").controller("warningsCtrl",["$cordovaBadge","metApi","$scope","$ionicModal","$ionicSlideBoxDelegate","$ionicScrollDelegate","$interval","$stateParams","$timeout",function(e,t,i,n,a,o,s,r,c){function l(e){var t=["January","February","March","April","May","June","July","Aug","September","October","November","December"],i=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],n=new Date(e);return i[n.getDay()+1]+" "+(n.getDate()+1)+"th of "+t[n.getMonth()]+" "+n.getFullYear()}var m=this,u=6e5;e.hasPermission().then(function(t){e.clear()},function(e){}),s(function(){$ionicHistory.clearCache().then(function(){$route.reload(),m.refresh_all_w(),$route.reload()}),$ionicHistory.clearHistory()},u),i.disableSwipe=function(){a.enableSlide(!1)},i.get_initial=function(){c(function(){i.slide(r.id)},1e3)},i.slideHasChanged=function(e){m.update_slide(e)},m.update_slide=function(e){titles=["Watches","Warnings","Sigmet","Airmet"],i.sub_title=titles[e]},i.slide=function(e){o.scrollTop(),a.slide(e)},m.refresh_all_w=function(){m.get_o_air(),m.get_sigmet(),m.get_warn(),m.get_watch()},m.refreshData=function(e){switch(e){case"Watches":m.get_watch();break;case"Warnings":m.get_warn();break;case"Sigmet":m.get_sigmet();break;case"Airmet":m.get_o_air()}},m.get_o_air=function(){t.get_o_air(function(e){m.o_items=e.items[0],console.log(m.o_items),m.o_items.insertionDateFormatted=l(e.items[0].insertionDate),"0"==m.o_items.flag&&(m.o_items=null)})},m.get_sigmet=function(){t.get_sigmet(function(e){m.s_items=e.items[0],m.s_items.insertionDateFormatted=l(e.items[0].insertionDate),"0"==m.s_items.flag&&(m.s_items=null)})},m.get_warn=function(){t.get_warn(function(e){m.w_items=e.items[0],m.w_items.insertionDateFormatted=l(e.items[0].insertionDate),"0"==m.w_items.flag&&(m.w_items=null)})},m.get_watch=function(){t.get_watch(function(e){m.wt_items=e.items[0],m.wt_items.insertionDateFormatted=l(e.items[0].insertionDate),"0"==m.wt_items.flag&&(m.wt_items=null)})},n.fromTemplateUrl("app/warnings/info_item.html",{scope:i,animation:"slide-in-up"}).then(function(e){i.w_details_modal=e}),i.w_info_close=function(){var e=document.querySelector(".modal");e.setAttribute("style",""),i.w_details_modal.hide()},i.w_info_open=function(e,n){switch(i.w_details_modal.show(),n){case"o":t.get_o_air(function(e){m.warning=e.items[0],m.warning.warnType=m.warning.forecaster},e);break;case"s":t.get_sigmet(function(e){m.warning=e.items[0]},e);break;case"w":t.get_warn(function(e){m.warning=e.items[0]},e);break;case"wt":t.get_watch(function(e){m.warning=e.items[0]},e)}},i.drag_close_modal=function(e){var t=window.innerHeight,n=e.gesture.center.pageY,a=document.querySelector(".modal"),o="; transition: all cubic-bezier(0.1, 0.7, 0.1, 1) 400ms;";a.setAttribute("style","margin-top:"+n+"px"+o),n>t/2&&i.w_info_close(),0>n&&a.setAttribute("style","margin-top:0px"+o),n>t&&i.w_info_close()},i.drag_release=function(){var e=document.querySelector(".modal"),t="; transition: all cubic-bezier(0.1, 0.7, 0.1, 1) 400ms;";e.setAttribute("style","margin-top:0px"+t)}}]);