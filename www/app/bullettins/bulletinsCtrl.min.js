angular.module("ionic.metApp").controller("BulletinsCtrl",["metApi","$scope","$ionicLoading","$timeout","$ionicModal","$cordovaDevice","$ionicPlatform","$cordovaPush","$ionicSlideBoxDelegate","$state","$stateParams","$route","$ionicScrollDelegate","$interval","$ionicHistory",function(e,t,i,n,o,l,s,a,r,c,_,u,f,d,b){function m(e){var t=["January","February","March","April","May","June","July","Aug","September","October","November","December"],i=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],n=new Date(e);return i[n.getDay()+1]+" "+(n.getDate()+1)+"th of "+t[n.getMonth()]+" "+n.getFullYear()}var g=this,h=6e5;d(function(){b.clearCache().then(function(){console.log("- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -"),console.log("cache cleared"),u.reload(),g.refresh_all_b(),u.reload()}),b.clearHistory()},h),t.disableSwipe=function(){r.enableSlide(!1)},s.ready(function(){if(window.cordova){l.getDevice()}}),t.get_initial=function(){n(function(){t.slide(_.id)},1e3),console.log("get initial slide",_.id)},t.slideHasChanged=function(e){},g.refresh_all_b=function(){g.getGIBulletins(),g.get_serv_b(),g.get_flood_b(),g.get_sea_b()},g.getGIBulletins=function(){e.get_b_info(function(e){g.b_info=e.items[0],g.b_info.insertionDateFormatted=m(e.items[0].insertionDate),"0"==g.b_info.flag&&(g.b_info=null)})},g.get_serv_b=function(){e.get_b_serv(function(e){g.s_items=e.items[0],g.s_items.insertionDateFormatted=m(e.items[0].insertionDate),"0"==g.s_items.flag&&(g.s_items=null)})},g.get_flood_b=function(){e.get_b_flood(function(e){g.f_items=e.items[0],g.f_items.insertionDateFormatted=m(e.items[0].insertionDate),"0"==g.f_items.flag&&(g.f_items=null)})},g.get_sea_b=function(){e.get_b_sea(function(e){g.r_items=e.items[0],g.r_items.insertionDateFormatted=m(e.items[0].insertionDate),"0"==g.r_items.flag&&(g.r_items=null)})},o.fromTemplateUrl("app/bullettins/info_item.html",{scope:t,animation:"scale-in"}).then(function(e){t.b_details_modal=e}),t.b_info_close=function(){t.b_details_modal.hide()},t.b_info_open=function(i,n){switch(t.b_details_modal.show(),n){case"b":e.get_b_info(function(e){g.bulletin=e.items[0],console.log(g.bulletin)},i);break;case"s":e.get_b_serv(function(e){g.bulletin=e.items[0],console.log(g.bulletin)},i);break;case"f":e.get_b_flood(function(e){g.bulletin=e.items[0],console.log(g.bulletin)},i);break;case"r":e.get_b_sea(function(e){g.bulletin=e.items[0],console.log(g.bulletin)},i)}},t.slide=function(e){f.scrollTop(),r.slide(e),console.debug("slide to",e)}}]);