angular.module("ionic.metApp").controller("BulletinsCtrl",["$cordovaBadge","metApi","$scope","$ionicLoading","$timeout","$ionicModal","$cordovaDevice","$ionicPlatform","$cordovaPush","$ionicSlideBoxDelegate","$state","$stateParams","$route","$ionicScrollDelegate","$interval","$ionicHistory",function(e,t,i,n,o,a,s,l,r,c,_,f,u,m,d,b){function g(e){var t=["January","February","March","April","May","June","July","Aug","September","October","November","December"],i=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],n=new Date(e);return i[n.getDay()+1]+" "+(n.getDate()+1)+"th of "+t[n.getMonth()]+" "+n.getFullYear()}var h=this,D=6e5;e.hasPermission().then(function(t){e.clear()},function(e){}),d(function(){b.clearCache().then(function(){u.reload(),h.refresh_all_b(),u.reload()}),b.clearHistory()},D),i.disableSwipe=function(){c.enableSlide(!1)},l.ready(function(){if(window.cordova){s.getDevice()}}),i.get_initial=function(){o(function(){i.slide(f.id)},1e3)},i.slideHasChanged=function(e){},h.refresh_all_b=function(){h.getGIBulletins(),h.get_serv_b(),h.get_flood_b(),h.get_sea_b()},h.getGIBulletins=function(){t.get_b_info(function(e){h.b_info=e.items[0],h.b_info.insertionDateFormatted=g(e.items[0].insertionDate),"0"==h.b_info.flag&&(h.b_info=null)})},h.get_serv_b=function(){t.get_b_serv(function(e){h.s_items=e.items[0],h.s_items.insertionDateFormatted=g(e.items[0].insertionDate),"0"==h.s_items.flag&&(h.s_items=null)})},h.get_flood_b=function(){t.get_b_flood(function(e){h.f_items=e.items[0],h.f_items.insertionDateFormatted=g(e.items[0].insertionDate),"0"==h.f_items.flag&&(h.f_items=null)})},h.get_sea_b=function(){t.get_b_sea(function(e){h.r_items=e.items[0],h.r_items.insertionDateFormatted=g(e.items[0].insertionDate),"0"==h.r_items.flag&&(h.r_items=null)})},a.fromTemplateUrl("app/bullettins/info_item.html",{scope:i,animation:"scale-in"}).then(function(e){i.b_details_modal=e}),i.b_info_close=function(){i.b_details_modal.hide()},i.b_info_open=function(e,n){switch(i.b_details_modal.show(),n){case"b":t.get_b_info(function(e){h.bulletin=e.items[0]},e);break;case"s":t.get_b_serv(function(e){h.bulletin=e.items[0]},e);break;case"f":t.get_b_flood(function(e){h.bulletin=e.items[0]},e);break;case"r":t.get_b_sea(function(e){h.bulletin=e.items[0]},e)}},i.slide=function(e){m.scrollTop(),c.slide(e)}}]);