angular.module("ionic.metApp").controller("ServicesCtrl",function(e,t,o,a,n,s,l,r,c,d){var g=this;o.disableSwipe=function(){d.enableSlide(!1)},g.refresh_all_a=function(){},g.get_o_aviation=function(){t.get_o_aviation(function(e){g.aviation_items=e.items})},g.get_aviation_radar=function(){},g.get_elninos=function(){t.get_elninos(function(e){g.el_infos=e,console.log("el nino"),console.log(e)})},g.get_rainandtemp=function(){t.get_rainandtemp(function(e){console.log("Rain and Temp "+e.items[0].year),g.rt=e.items})},g.get_drywet=function(){t.get_drywet(function(e){g.dw=e.items})},g.agrotrini=function(){t.get_agrotrini(function(e){g.atrin=e.items[0],console.log(g.atrin)}),t.get_agroData("area",function(e){console.log(e),g.area=e}),t.get_agroData("rainfall",function(e){console.log(e),g.rain=e}),t.get_agroData("temperature",function(e){console.log(e),g.temp=e}),t.get_agroData("summary",function(e){console.log(e),g.sum=e})},g.agrotbg=function(){t.get_agrotbg(function(e){g.atbg=e.items[0],console.log("Agro TBG"),console.log(g.atrin)}),t.get_agroDataTbg("area",function(e){console.log("Agro Info tbg"),console.log(e),g.areatbg=e}),t.get_agroDataTbg("rainfall",function(e){console.log("Rain Info"),console.log(e),g.raintbg=e}),t.get_agroDataTbg("temperature",function(e){console.log("Temp Info"),console.log(e),g.temptbg=e}),t.get_agroDataTbg("summary",function(e){console.log("Summary Info"),console.log(e),g.sumtbg=e})},s.fromTemplateUrl("app/services/elrtinfo_item.html",{scope:o,animation:"scale-in"}).then(function(e){o.elrtinfo_modal=e}),o.closeModal=function(){o.elrtinfo_modal.hide()},o.cinfo_open=function(e,i){switch(i){case"el":t.get_elnino(function(e){console.log("el nino"),g.d_item=e.items[0],console.log(g.d_item)},e);break;case"rt":t.get_rainandtemp(function(e){console.log("rain and temp"),g.d_item=e.items[0],console.log(g.d_item)},e);break;case"dw":t.get_drywet(function(e){console.log("dry wetp"),g.d_item=e.items[0],console.log(g.d_item)},e)}o.elrtinfo_modal.show()},o.slideHasChanged_a=function(e){g.update_slide_a(e)},g.update_slide_a=function(e){titles=["Satellite","Radar","Weather Report","Forecast"],o.sub_title=titles[e]},o.slideHasChanged_c=function(e){g.update_slide_c(e)},g.update_slide_c=function(e){titles=["El Nino Update","Rainfall & Temp","Dry/Wet Outlook"],o.sub_title=titles[e]},o.slideHasChanged_m=function(e){g.update_slide_m(e)},g.update_slide_m=function(e){titles=[""],o.sub_title=titles[e]},o.slideHasChanged_t=function(e){g.update_slide_t(e)},g.update_slide_t=function(e){titles=["3-day Natinwide","3-day Tobago"],o.sub_title=titles[e]},o.slideHasChanged_ag=function(e){g.update_slide_ag(e)},g.update_slide_ag=function(e){titles=["Trinidad","Tobago"],o.sub_title=titles[e]},o.slide=function(e){d.slide(e)},g.radars_150=function(){g.radars_150_list=e.all_of_cat(150),console.log("radars 150",g.radars_150_list)},g.radars_250=function(){g.radars_250_list=e.all_of_cat(250),console.log("radars 250",g.radars_250_list)},g.get_radar_400=function(){alert()},g.get_metars=function(){t.get_metar(function(e){var t=e.items,o=[{id:1,icon:"icon ion-ios-location-outline",el:"met-loc",show:!0},{id:2,icon:"icon ion-thermometer",el:null,show:!1},{id:3,icon:"icon ion-thermometer",el:"temp",show:!0},{id:4,icon:"icon ion-waterdrop",el:"dew",show:!0},{id:5,icon:"icon ion-ios-speedometer-outline",el:"pressure",show:!0},{id:6,icon:"icon ion-ios-analytics-outline",el:"winds",show:!0},{id:7,icon:"icon",el:"weather",show:!1},{id:8,el:"weather",show:!1},{id:9,icon:"icon ion-ios-cloudy-outline",el:"clouds",show:!0},{id:10,icon:"icon ion-umbrella",el:"weather",show:!1}];for(g.mdata=[],i=0;i<t.length;i++)"TTPP"==t[i].station&&g.mdata.push({id:t[i].id,label:t[i].label,station:t[i].station,value:t[i].value,icon:o[i].icon,el:o[i].el,show:o[i].show})}),g.sigmet()},g.sigmet=function(){t.get_sigmet(function(e){g.sig=e.items,console.debug("sigmet",g.sig)})}}).controller("RadarDetailCtrl",function(e,t,i,o,a,n,s,l,r,c){var d=this;e.close_loading=function(){r.hide()},e.get_radar_detail=function(){console.log("here"),d.radar=o.get(t.id),i.get_radar(function(e){var t=new Image;t.src=e.image_src,t.style.maxWidth="100%";var i=$(".img_holder");i.html(t),i.find("img").wrap('<a href="'+e.image_src+'" class="swipebox" title="'+d.radar.title+'"></a>'),console.log("radar image",e)},t.id),d.radar=o.get(t.id),console.debug("radar item detail",o.get(t.id))},e.reload_page=function(){e.get_radar_detail(t.id),console.log(t.id)},e.$on("loading:show",function(){r.show({template:' <ion-spinner></ion-spinner><br><button class="button button-light button-block" ng-click="close_loading()">Cancel</button>',scope:e})})}).factory("Radars",function(){var e=[{id:0,img:" ",title:"Radar Loop",sub:"Loops all radar scans.",cat:null},{id:1,img:"app/services/radar/eht7.png",title:"EHT (Echo Height Top)",sub:"Gives a representation of the height to which the top of the clouds extend.",cat:150},{id:2,img:"app/services/radar/hwind7.png",title:"HWIND (Horizontal Wind)",sub:"Shows wind flow at a specific altitude.",cat:150},{id:3,img:"http://190.58.130.190/web/aviation/RadarPages2014/150km/max7.png",title:"MAX (Maximum)",sub:"Shows a 2 Dimensional (2D) flow for the horizontal and vertical profile of the clouds.",cat:150},{id:4,img:" ",title:"PAC",sub:"No Subtitle",cat:150},{id:5,img:"app/services/radar/ppi7.png",title:"PPI (Plan Position Indicator)",sub:"A representation of the cloud echoes in a horizontal plane.",cat:150},{id:6,img:"app/services/radar/sri7.png",title:"SRI (Surface Rainfall Intensity)",sub:"An estimate of rainfall intensity associated with different echoes.",cat:150},{id:7,img:"app/services/radar/vvp7.png",title:"VVP (Velocity Volume Processing)",sub:"Provides an estimate of the wind profile up to a certain height.",cat:150},{id:8,img:"http://190.58.130.190/web/aviation/RadarPages2014/200km/eht1.png",title:"ETH(Height)",sub:"Gives a representation of the height to which the top of the clouds extend.",cat:250},{id:9,img:"",title:"",sub:"",cat:0},{id:10,img:"http://190.58.130.190/web/aviation/RadarPages2014/200km/hwind7.png",title:"HWIND (Horizontal Wind)",sub:"Shows wind flow at a specific altitude.",cat:250},{id:11,img:"http://190.58.130.190/web/aviation/RadarPages2014/200km/max7.png",title:"MAX (Maximum)",sub:"Shows a 2 Dimensional (2D) flow for the horizontal and vertical profile of the clouds.",cat:250},{id:12,img:"http://190.58.130.190/web/aviation/RadarPages2014/200km/ppi7.png",title:"PPI (Plan Position Indicator)",sub:"A representation of the cloud echoes in a horizontal plane.",cat:250},{id:13,img:"http://190.58.130.190/web/aviation/RadarPages2014/200km/sri7.png",title:"SRI (Surface Rainfall Intensity)",sub:"An estimate of rainfall intensity associated with different echoes.",cat:250},{id:14,img:"http://190.58.130.190/web/aviation/RadarPages2014/200km/vvp7.png",title:"VVP (Velocity Volume Processing)",sub:"Provides an estimate of the wind profile up to a certain height.",cat:250},{id:15,img:"http://190.58.130.190/web/aviation/RadarPages2014/400km/400ppi7.png",title:"PPI (Plan Position Indicator)",sub:"A representation of the cloud echoes in a horizontal plane.",cat:400}];return{all_of_cat:function(t){for(var i=[],o=0;o<e.length;o++)e[o].cat===parseInt(t)&&i.push(e[o]);return i},get:function(t){for(var i=0;i<e.length;i++)if(e[i].id===parseInt(t))return e[i];return null}}}).controller("AWSCtrl",function(e,t,o,a,n,s,l,r,c,d){var g=this;t.activeButton="a";var u=[],m=[],p=[],_=[],h=[],f=[],w=[],v=["Pi_temp","Br_temp","Ca_temp","Ch_temp","El_temp","Pe_temp"],P=["Pi_pressure","Br_pressure","Ca_pressure","Ch_pressure","El_pressure","Pe_pressure"],y=["Pi_gust","Br_gust","Ca_gust","Ch_gust","El_gust","Pe_gust"],C=["Pi_precip","Br_precip","Ca_precip","Ch_precip","El_precip","Pe_precip"],I=["Pi_humidity","Br_humidity","Ca_humidity","Ch_humidity","El_humidity","Pe_humidity"],k=["Pi_wind_d","Br_wind_d","Ca_wind_d","Ch_wind_d","El_wind_d","Pe_wind_d"],S=["Pi_wind_s","Br_wind_s","Ca_wind_s","Ch_wind_s","El_wind_s","Pe_wind_s"];g.active_item="Temperature";var R=[{city:"Piarco",desc:"Piarco  (BASE) AWS",lat:10.602912,"long":-61.33564},{city:"Brasso",desc:"Brasso Venado AWS",lat:10.399413,"long":-61.317268},{city:"Caroni",desc:"Caroni AWS",lat:10.606881,"long":-61.383883},{city:"Chatham",desc:"Chatham  AWS",lat:10.115793,"long":-61.74162},{city:"El Reposo",desc:"El Reposo AWS",lat:10.589908,"long":-61.114339},{city:"Penal",desc:"Penal AWS",lat:10.168662,"long":-61.43783},{city:"Centeno",desc:"Centeno AWS",lat:10.352226,"long":-61.192286}];g.get_aws=function(t){for(x=0;x<R.length;x++)e.get_aws(function(e){var t=e.items.length,i=e.items;for(z=0;z<t;z++)console.log(i[z].location),"Temperature"==i[z].item&&(u[i[z].location.substr(0,2)+"_temp"]=i[z],u[i[z].location.substr(0,2)+"_temp"].value=parseInt(u[i[z].location.substr(0,2)+"_temp"].value)),"Pressure"==i[z].item&&(m[i[z].location.substr(0,2)+"_pressure"]=i[z],m[i[z].location.substr(0,2)+"_pressure"].value=parseInt(m[i[z].location.substr(0,2)+"_pressure"].value)),"Gust"==i[z].item&&(p[i[z].location.substr(0,2)+"_gust"]=i[z]),"Precipitation"==i[z].item&&(_[i[z].location.substr(0,2)+"_precip"]=i[z]),"Humidity"==i[z].item&&(h[i[z].location.substr(0,2)+"_humidity"]=i[z]),"Wind Direction"==i[z].item&&(f[i[z].location.substr(0,2)+"_wind_d"]=i[z]),"Wind Speed"==i[z].item&&(w[i[z].location.substr(0,2)+"_wind_s"]=i[z])},R[x].city);o(function(){t&&$(".gm-style-iw").each(function(e,t){var i=$(this);$(this).css({top:"32px",left:"15px"}),i.next().remove(),i.parent().css({"margin-top":"44px",height:"0px",width:"0px"}).addClass("no-wh"),$(this).parent().find("img").remove();var o=$(this).prev(),a=(o.find("div:eq(1)").remove(),o.find("div:last"));a.hide().addClass("second"),a.prev().find("div:eq(1), div:eq(2)").remove(),a.prev("div").prev("div").remove(),console.debug(u[v[e]],e),void 0!=u[v[e]]&&u[v[e]].value?$(this).find(".infoWindowContent").html(u[v[e]].value):i.parent().hide()})},2e3)},t.initialise=function(){var e=new google.maps.LatLng(10.84584,-60.594896),o={center:e,zoom:8,mapTypeId:google.maps.MapTypeId.ROADMAP},a=new google.maps.Map(document.getElementById("map"),o);t.map=a,navigator.geolocation.getCurrentPosition(function(e){a.setCenter(new google.maps.LatLng(e.coords.latitude,e.coords.longitude))}),t.markers=[];var n=function(e){var i=new google.maps.InfoWindow,o=new google.maps.Marker({position:new google.maps.LatLng(e.lat,e["long"]),map:t.map,animation:google.maps.Animation.DROP,title:e.city,icon:" "});o.content='<div class="infoWindowContent" data-location="'+e.city+'">'+e.desc+"</div>",i.setContent(o.content),i.open(t.map,o),t.markers.push(o)};for(i=0;i<R.length;i++)n(R[i]);g.get_aws(!0)},g.aws_click=function(e){var i="";switch(t.activeButton=e,e){case"temp":i=u,b=v,g.active_item="Temperature";break;case"press":i=m,b=P,g.active_item="Pressure";break;case"gust":i=p,b=y,g.active_item="Gust";break;case"precip":i=_,b=C,g.active_item="Precipitation";break;case"humidity":i=h,b=I,g.active_item="Humidity";break;case"wind_d":i=f,b=k,g.active_item="Wind Direction";break;case"wind_s":i=w,b=S,g.active_item="Wind Speed";break;default:i=u,b=v,g.active_item="Temperature"}$(".gm-style-iw").each(function(e,t){var o=$(this);void 0!=i[b[e]]&&i[b[e]].value?(o.parent().show(),$(this).find(".infoWindowContent").html(i[b[e]].value)):o.parent().hide()})},google.maps.event.addDomListener(document.getElementById("map"),"load",t.initialise()),g.refreshData=function(e){console.log(e),d.reload(),g.get_aws(!1),g.aws_click(e)}}).run(function(e,t,i,o,a){});