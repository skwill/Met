angular.module("ionic.metApp").controller("ServicesCtrl",function(t,e,a,o,n,l,s,r,c,d,g){var u=this;a.disableSwipe=function(){d.enableSlide(!1)},u.refresh_all_a=function(){},u.get_o_aviation=function(){e.get_o_aviation(function(t){u.aviation_items=t.items})},u.get_aviation_radar=function(){},u.get_elninos=function(){e.get_elninos(function(t){u.el_infos=t[0]}),e.get_option_files(function(t){a.image1="data: ;base64,"+t.elnino0.data,a.image2="data: ;base64,"+t.elnino1.data,a.image3="data: ;base64,"+t.elnino2.data},"/file/search?category=elnino")},u.get_rainandtemp=function(){e.get_rainandtemp(function(t){for(u.key_list=t.items[0].para1.split("\r\n"),u.ir_list=t.items[0].para12.split("\r\n"),x=0;x<u.key_list.length;x++)u.key_list[x].trim();for(x=0;x<u.ir_list.length;x++)u.ir_list[x].trim();u.rt=t.items[0]}),e.get_option_files(function(t){a.image4="data: ;base64,"+t.rainandtemp0.data,a.image5="data: ;base64,"+t.rainandtemp1.data},"/file/search?category=rainandtemp")},u.get_drywet=function(){e.get_drywet(function(t){u.dw=t.items[0]}),e.get_option_files(function(t){a.image6="data: ;base64,"+t.dryandwetspell0.data},"/file/search?category=dryandwetspell")},u.agrotrini=function(){e.get_agrotrini(function(t){u.atrin=t.items[0]}),e.get_option_files(function(t){a.image_agro_trin="data: ;base64,"+t.agrotrini0.data},"/file/search?category=agrotrini"),e.get_agroData("summary",function(t){u.sum=t})},u.agrotbg=function(){e.get_agrotbg(function(t){u.atbg=t.items[0]}),e.get_option_files(function(t){a.image_agro_bago="data: ;base64,"+t.agrotobago0.data},"/file/search?category=agrotobago"),e.get_agroDataTbg("summary",function(t){u.sumtbg=t})},l.fromTemplateUrl("app/services/elrtinfo_item.html",{scope:a,animation:"scale-in"}).then(function(t){a.elrtinfo_modal=t}),a.closeModal=function(){a.elrtinfo_modal.hide()},a.cinfo_open=function(t,i){switch(i){case"el":e.get_elnino(function(t){u.d_item=t.items[0]},t);break;case"rt":e.get_rainandtemp(function(t){u.d_item=t.items[0]},t);break;case"dw":e.get_drywet(function(t){u.d_item=t.items[0]},t)}a.elrtinfo_modal.show()},a.slideHasChanged_a=function(t){u.update_slide_a(t)},u.update_slide_a=function(t){titles=["Satellite","Radar","Weather Report","Forecast"],a.sub_title=titles[t]},a.slideHasChanged_c=function(t){u.update_slide_c(t)},u.update_slide_c=function(t){titles=["El Nino Update","Rainfall & Temp","Dry/Wet Outlook"],a.sub_title=titles[t]},a.slideHasChanged_m=function(t){u.update_slide_m(t)},u.update_slide_m=function(t){titles=[""],a.sub_title=titles[t]},a.slideHasChanged_t=function(t){u.update_slide_t(t)},u.update_slide_t=function(t){titles=["3-day Natinwide","3-day Tobago"],a.sub_title=titles[t]},a.slideHasChanged_ag=function(t){u.update_slide_ag(t)},u.update_slide_ag=function(t){titles=["Trinidad","Tobago"],a.sub_title=titles[t]},a.slide=function(t){g.scrollTop(),d.slide(t)},u.radars_150=function(){u.radars_150_list=t.all_of_cat(150)},u.radars_250=function(){u.radars_250_list=t.all_of_cat(250)},u.get_radar_400=function(){alert()},u.get_metars=function(){e.get_metar(function(t){var e=t.items,a=[{id:1,icon:"icon ion-ios-location-outline",el:"met-loc",show:!0},{id:2,icon:"icon ion-thermometer",el:null,show:!1},{id:3,icon:"icon ion-thermometer",el:"temp",show:!0},{id:4,icon:"icon ion-waterdrop",el:"dew",show:!0},{id:5,icon:"icon ion-ios-speedometer-outline",el:"pressure",show:!0},{id:6,icon:"icon ion-ios-analytics-outline",el:"winds",show:!0},{id:7,icon:"icon",el:"weather",show:!1},{id:8,el:"weather",show:!1},{id:9,icon:"icon ion-ios-cloudy-outline",el:"clouds",show:!0},{id:10,icon:"icon ion-umbrella",el:"weather",show:!1}];for(u.mdata=[],i=0;i<e.length;i++)"TTPP"==e[i].station&&u.mdata.push({id:e[i].id,label:e[i].label,station:e[i].station,value:e[i].value,icon:a[i].icon,el:a[i].el,show:a[i].show})}),u.sigmet()},u.sigmet=function(){e.get_sigmet(function(t){u.sig=t.items})}}).controller("RadarDetailCtrl",function(t,e,i,a,o,n,l,s,r,c,d,g,u,m){var p=this;t.close_loading=function(){r.hide()},t.get_radar_detail=function(){t.zoomMin=1,p.radar=a.get(e.id),i.get_radar(function(e){var i=new Image;i.src=e.image_src,t.image=e.image_src},p.radar.code),p.radar=a.get(e.id)},t.reload_page=function(){t.get_radar_detail(e.id)},t.$on("loading:show",function(){r.show({template:' <ion-spinner class="light"></ion-spinner><br><button class="button button-light button-block" ng-click="close_loading()">Cancel</button>',scope:t})}),t.showImages=function(e){t.showModal("app/services/radar/radar_image_modal.html")},t.showModal=function(e){g.fromTemplateUrl(e,{scope:t,animation:"slide-in-up"}).then(function(e){t.modal=e,t.modal.show()})},t.closeModal=function(){t.modal.hide(),t.modal.remove()},t.updateSlideStatus=function(e){var i=u.$getByHandle("scrollHandle"+e).getScrollPosition.zoom;m.enableSlide(i==t.zoomMin?!0:!1)}}).factory("Radars",function(){var t=[{id:0,img:" ",title:"Radar Loop",sub:"Loops all radar scans.",cat:null},{id:1,img:"app/services/radar/eht7.png",title:"EHT (Echo Height Top)",sub:"Gives a representation of the height to which the top of the clouds extend.",cat:150,code:"150eht"},{id:2,img:"app/services/radar/hwind7.png",title:"HWIND (Horizontal Wind)",sub:"Shows wind flow at a specific altitude.",cat:150,code:"150hwind"},{id:3,img:"http://190.58.130.190/web/aviation/RadarPages2014/150km/max7.png",title:"MAX (Maximum)",sub:"Shows a 2 Dimensional (2D) flow for the horizontal and vertical profile of the clouds.",cat:150,code:"150max"},{id:4,img:" ",title:"PAC",sub:"No Subtitle",cat:150,code:"150pac"},{id:5,img:"app/services/radar/ppi7.png",title:"PPI (Plan Position Indicator)",sub:"A representation of the cloud echoes in a horizontal plane.",cat:150,code:"150ppi"},{id:6,img:"app/services/radar/sri7.png",title:"SRI (Surface Rainfall Intensity)",sub:"An estimate of rainfall intensity associated with different echoes.",cat:150,code:"150sri"},{id:7,img:"app/services/radar/vvp7.png",title:"VVP (Velocity Volume Processing)",sub:"Provides an estimate of the wind profile up to a certain height.",cat:150,code:"150vvp"},{id:8,img:"http://190.58.130.190/web/aviation/RadarPages2014/200km/eht1.png",title:"ETH(Height)",sub:"Gives a representation of the height to which the top of the clouds extend.",cat:250,code:"250eth"},{id:9,img:"",title:"",sub:"",cat:0},{id:10,img:"http://190.58.130.190/web/aviation/RadarPages2014/200km/hwind7.png",title:"HWIND (Horizontal Wind)",sub:"Shows wind flow at a specific altitude.",cat:250,code:"250hwind"},{id:11,img:"http://190.58.130.190/web/aviation/RadarPages2014/200km/max7.png",title:"MAX (Maximum)",sub:"Shows a 2 Dimensional (2D) flow for the horizontal and vertical profile of the clouds.",cat:250,code:"250max"},{id:12,img:"http://190.58.130.190/web/aviation/RadarPages2014/200km/ppi7.png",title:"PPI (Plan Position Indicator)",sub:"A representation of the cloud echoes in a horizontal plane.",cat:250,code:"250ppi"},{id:13,img:"http://190.58.130.190/web/aviation/RadarPages2014/200km/sri7.png",title:"SRI (Surface Rainfall Intensity)",sub:"An estimate of rainfall intensity associated with different echoes.",cat:250,code:"250sri"},{id:14,img:"http://190.58.130.190/web/aviation/RadarPages2014/200km/vvp7.png",title:"VVP (Velocity Volume Processing)",sub:"Provides an estimate of the wind profile up to a certain height.",cat:250,code:"250vvp"},{id:15,img:"http://190.58.130.190/web/aviation/RadarPages2014/400km/400ppi7.png",title:"PPI (Plan Position Indicator)",sub:"A representation of the cloud echoes in a horizontal plane.",cat:400,code:"400ppi"},{id:16,img:null,title:"Satellite",sub:null,cat:null}];return{all_of_cat:function(e){for(var i=[],a=0;a<t.length;a++)t[a].cat===parseInt(e)&&i.push(t[a]);return i},get:function(e){for(var i=0;i<t.length;i++)if(t[i].id===parseInt(e))return t[i];return null}}}).controller("AWSCtrl",function(t,e,i,a,o,n,l,s,r,d,g,u){e.ai=[],e.mapCreated=function(t){e.map=t},e.centerOnMe=function(){e.map&&(u.show({content:"Getting current location...",showBackdrop:!1}),navigator.geolocation.getCurrentPosition(function(t){e.map.setCenter(new google.maps.LatLng(t.coords.latitude,t.coords.longitude)),u.hide()},function(t){n.alert({title:"Unable to get location",template:t.message})}))},e.closeModal=function(t){o.ready(function(){window.StatusBar&&StatusBar.styleLightContent()}),e.modal.hide()},e.$on("modal.hidden",function(){s.release()}),g.ace=function(i){o.ready(function(){window.StatusBar&&StatusBar.styleBlackTranslucent()}),e.title=i,t.get_aws(function(t){var i=t.items.length,a=t.items;for(z=0;z<i;z++)"Temperature"==a[z].item&&(e.ai[0]=a[z]),"Pressure"==a[z].item&&(e.ai[1]=a[z]),"Gust"==a[z].item&&(e.ai[2]=a[z]),"Precipitation"==a[z].item&&(e.ai[3]=a[z]),"Humidity"==a[z].item&&(e.ai[4]=a[z]),"Wind Direction"==a[z].item&&(e.ai[5]=a[z]),"Wind Speed"==a[z].item&&(e.ai[6]=a[z]);var o='<p class="text-center">No data</p>';for(c=0;c<e.ai.length;c++)void 0!=e.ai[c]&&(o+='<div class="row"><div class="card wide"><div class="item item-divider">'+e.ai[c].item+'</div><div class="item item-text-wrap"><p>'+e.ai[c].value+"</p></div></div></div>");n.alert({title:e.title,template:o,cssClass:"aws_popup"})},i)}}).directive("map",function(t,e,a,o,n,l){return{restrict:"E",scope:{onCreate:"&"},link:function(t,e,a){function o(){var a=[{city:"Piarco",desc:"Piarco  (BASE) AWS",lat:10.602912,"long":-61.33564},{city:"Brasso",desc:"Brasso Venado AWS",lat:10.399413,"long":-61.317268},{city:"Caroni",desc:"Caroni AWS",lat:10.606881,"long":-61.383883},{city:"Chatham",desc:"Chatham  AWS",lat:10.115793,"long":-61.74162},{city:"El Reposo",desc:"El Reposo AWS",lat:10.589908,"long":-61.114339},{city:"Penal",desc:"Penal AWS",lat:10.168662,"long":-61.43783},{city:"Centeno",desc:"Centeno AWS",lat:10.352226,"long":-61.192286}],o={center:new google.maps.LatLng(10.84584,-60.594896),zoom:9,mapTypeId:google.maps.MapTypeId.ROADMAP},n=new google.maps.Map(e[0],o);t.onCreate({map:n}),navigator.geolocation.getCurrentPosition(function(t){n.setCenter(new google.maps.LatLng(t.coords.latitude,t.coords.longitude))}),google.maps.event.addDomListener(e[0],"mousedown",function(t){return t.preventDefault(),!1}),t.markers=[];var s=function(e){var i=new google.maps.Marker({position:new google.maps.LatLng(e.lat,e["long"]),map:n,animation:google.maps.Animation.DROP,title:e.city});t.markers.push(i),i.addListener("click",function(){l.ace(this.title)})};for(i=0;i<a.length;i++)s(a[i])}"complete"===document.readyState?o():google.maps.event.addDomListener(window,"load",o)}}});