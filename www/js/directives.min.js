angular.module("ionic.metApp.directives",[]).constant("WEATHER_ICONS",{partlycloudy:"ion-ios-partlysunny-outline",mostlycloudy:"ion-ios-partlysunny-outline",cloudy:"ion-ios-cloudy-outline",rain:"ion-ios-rainy-outline",tstorms:"ion-ios-thunderstorm-outline",sunny:"ion-ios-sunny-outline","clear-day":"ion-ios-sunny-outline",nt_clear:"ion-ios-moon-outline","clear-night":"ion-ios-moon-outline"}).directive("weatherIcon",function(e){return{restrict:"E",replace:!0,scope:{icon:"="},template:'<i class="icon" ng-class="weatherIcon"></i>',link:function(t){t.$watch("icon",function(n){if(n){var r=n;r in e?t.weatherIcon=e[r]:t.weatherIcon=e.cloudy}})}}}).directive("currentTime",function(e,t){return{restrict:"E",replace:!0,template:'<span class="current-time">{{currentTime}}</span>',scope:{localtz:"="},link:function(n,r,o){e(function i(){n.localtz&&(n.currentTime=t("date")(+new Date,"h:mm")+n.localtz),e(i,500)})}}}).directive("currentWeather",function(e,t,n){return{restrict:"E",replace:!0,templateUrl:"app/home/current-weather.html",scope:!0,compile:function(r,o){return function(r,o,i){t.$on("settings.changed",function(e){var t=n.get("tempUnits");if(r.forecast){var o=r.forecast,i=r.current;"f"==t?(r.highTemp=o.forecastday[0].high.fahrenheit,r.lowTemp=o.forecastday[0].low.fahrenheit,r.currentTemp=Math.floor(i.temp_f)):(r.highTemp=o.forecastday[0].high.celsius,r.lowTemp=o.forecastday[0].low.celsius,r.currentTemp=Math.floor(i.temp_c))}}),r.$watch("current",function(e){var t=n.get("tempUnits");e&&("f"==t?r.currentTemp=Math.floor(e.currently.temperature):r.currentTemp=Math.floor(e.currently.temperature),"f"==t?(r.highTemp=Math.floor(e.daily.data[0].temperatureMax),r.lowTemp=Math.floor(e.daily.data[0].temperatureMin)):(r.highTemp=Math.floor(e.daily.data[0].temperatureMax),r.lowTemp=Math.floor(e.daily.data[0].temperatureMin)))}),e(function(){{var t=window.innerHeight,n=o[0].offsetHeight;document.querySelector("#header").offsetHeight}o[0].style.paddingTop=t-n+20+"px",angular.element(document.querySelector(".content")).css("-webkit-overflow-scrolling","auto"),e(function(){angular.element(document.querySelector(".content")).css("-webkit-overflow-scrolling","touch")},50)})}}}}).directive("forecast",function(e){return{restrict:"E",replace:!0,templateUrl:"app/home/forecast.html",link:function(e,t,n){}}}).directive("weatherBox",function(e){return{restrict:"E",replace:!0,transclude:!0,scope:{title:"@"},template:'<div class="weather-box"><h4 class="title">{{title}}</h4><div ng-transclude></div></div>',link:function(e,t,n){}}}).directive("scrollEffects",function(){return{restrict:"A",link:function(e,t,n){var r,o,i,c=document.querySelector(".bg-image");t.bind("scroll",function(e){i||(i=document.getElementById("header")),o=e.detail.scrollTop,o>=0?i.style.webkitTransform="translate3d(0, 0, 0)":0>o&&(i.style.webkitTransform="translate3d(0, "+-o+"px, 0)"),r=Math.min(.6,o/1e3),ionic.requestAnimationFrame(function(){i.style.opacty=1-r,c&&(c.style.opacity=1-r)})})}}}).directive("backgroundCycler",function(e,t){var n=function(n,r,o){var i=r.children()[0],c=n.$new();c.url=o;var a=e("<background-image></background-image>")(c);t.enter(a,r,null,function(){console.log("Inserted")}),i&&t.leave(angular.element(i),function(){console.log("Removed")})};return{restrict:"E",link:function(e,t,r){e.$watch("activeBgImage",function(r){if(r){console.log("Active bg image changed",r);var o=r,i="http://farm"+o.farm+".static.flickr.com/"+o.server+"/"+o.id+"_"+o.secret+"_z.jpg";n(e,t,i)}})}}}).directive("backgroundImage",function(e,t){return{restrict:"E",template:'<div class="bg-image"><div class="background-vignette"></div></div>',replace:!0,scope:!0,link:function(e,t,n){e.url&&(t[0].style.backgroundImage="url("+e.url+")")}}});