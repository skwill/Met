angular.module("ionic.metApp.directives",[]).constant("WEATHER_ICONS",{partlycloudy:"ion-ios-partlysunny-outline",mostlycloudy:"ion-ios-partlysunny-outline",cloudy:"ion-ios-cloudy-outline",rain:"ion-ios-rainy-outline",tstorms:"ion-ios-thunderstorm-outline",sunny:"ion-ios-sunny-outline","clear-day":"ion-ios-sunny-outline",nt_clear:"ion-ios-moon-outline","clear-night":"ion-ios-moon-outline"}).directive("weatherIcon",function(e){return{restrict:"E",replace:!0,scope:{icon:"="},template:'<i class="icon" ng-class="weatherIcon"></i>',link:function(t){t.$watch("icon",function(r){if(r){var n=r;n in e?t.weatherIcon=e[n]:t.weatherIcon=e.cloudy}})}}}).directive("currentIcon",function(e){return{restrict:"E",replace:!0,scope:{icon:"="},template:'<i class="icon" ng-class="currentIcon"></i>',link:function(t){t.$watch("icon",function(r){if(r){var n=r;n in e?t.currentIcon=e[n]:t.currentIcon=e.cloudy}})}}}).directive("currentTime",function(e,t){return{restrict:"E",replace:!0,template:'<span class="current-time">{{currentTime}}</span>',scope:{localtz:"="},link:function(r,n,i){e(function o(){r.localtz&&(r.currentTime=t("date")(+new Date,"h:mm")+r.localtz),e(o,500)})}}}).directive("currentWeather",function(e,t,r){return{restrict:"E",replace:!0,templateUrl:"app/home/current-weather.html",controller:"HomeCtrl",scope:!0,compile:function(n,i){return function(n,i,o){t.$on("settings.changed",function(e){var t=r.get("tempUnits");if(n.current){var i=n.current.daily.data[0],o=n.current.currently;"f"==t?(n.highTemp=i.temperatureMax,n.lowTemp=i.temperatureMin,n.currentTemp=Math.floor(o.temperature)):(n.highTemp=i.temperatureMax,n.lowTemp=i.temperatureMin,n.currentTemp=Math.floor(.5556*(o.temperature-32)))}}),n.$watch("current",function(e){var t=r.get("tempUnits");e&&("f"==t?n.currentTemp=Math.floor(e.currently.temperature):n.currentTemp=Math.floor(.5556*(e.currently.temperature-32)),"f"==t?(n.highTemp=Math.floor(e.daily.data[0].temperatureMax),n.lowTemp=Math.floor(e.daily.data[0].temperatureMin)):(n.highTemp=Math.floor(e.daily.data[0].temperatureMax),n.lowTemp=Math.floor(e.daily.data[0].temperatureMin)))}),e(function(){{var t=window.innerHeight,r=i[0].offsetHeight;document.querySelector("#header").offsetHeight}i[0].style.paddingTop=(t-r)/4+"px",angular.element(document.querySelector(".content")).css("-webkit-overflow-scrolling","auto"),e(function(){angular.element(document.querySelector(".content")).css("-webkit-overflow-scrolling","touch")},50)})}}}}).directive("forecast",function(e){return{restrict:"E",replace:!0,templateUrl:"app/home/forecast.html",link:function(e,t,r){}}}).directive("weatherBox",function(e){return{restrict:"E",replace:!0,transclude:!0,scope:{title:"@"},template:'<div class="weather-box"><h4 class="title">{{title}}</h4><div ng-transclude></div></div>',link:function(e,t,r){}}}).directive("scrollEffects",function(){return{restrict:"A",link:function(e,t,r){{var n,i,o,c=document.querySelector(".bg-image");document.getElementById("ff")}t.bind("scroll",function(e){o||(o=document.getElementById("header")),i=e.detail.scrollTop,i>=0?o.style.webkitTransform="translate3d(0, 0, 0)":0>i&&(o.style.webkitTransform="translate3d(0, "+-i+"px, 0)"),n=Math.min(.6,i/1e3);{var t=10;"-webkit-filter: blur("+Math.abs(n*t)+"px);-moz-filter: blur("+n*t+"px);-o-filter: blur("+n*t+"px);-ms-filter: blur("+n*t+"px);filter: url('data:image/svg+xml;utf9,<svg%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'><filter%20id='blur'><feGaussianBlur%20stdDeviation='60'%20/></filter></svg>#blur');filter:progid:DXImageTransform.Microsoft.Blur(PixelRadius='"+n*t+"');clip: rect(520px 573px 516px 351px);"}ionic.requestAnimationFrame(function(){o.style.opacty=1-n,c&&(c.style.opacity=1-n)})})}}}).directive("backgroundCycler",function(e,t){var r=function(r,n,i){var o=n.children()[0],c=r.$new();c.url=i;var a=e("<background-image></background-image>")(c);t.enter(a,n,null,function(){console.log("Inserted")}),o&&t.leave(angular.element(o),function(){console.log("Removed")})};return{restrict:"E",link:function(e,t,n){e.$watch("activeBgImage",function(n){if(n){console.log("Active bg image changed",n);var i=n,o="http://farm"+i.farm+".static.flickr.com/"+i.server+"/"+i.id+"_"+i.secret+"_z.jpg";r(e,t,o)}})}}}).directive("backgroundImage",function(e,t){return{restrict:"E",template:'<div class="bg-image"><div class="background-vignette"></div></div>',replace:!0,scope:!0,link:function(e,t,r){e.url&&(t[0].style.backgroundImage="url("+e.url+")")}}});